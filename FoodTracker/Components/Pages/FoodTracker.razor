@page "/FoodTracker"
@using global::FoodTracker.Scripts
@rendermode InteractiveServer

<link href="./Styles/FoodTracker.css" rel="stylesheet"/>

<PageTitle>Foood Tracker</PageTitle>

<h3>Welcome to your food tracker</h3>

<!-- Add food items to the list -->
<InputSelect @bind-Value:get="selectedFood" @bind-Value:set="SetSelectedFood">
    <option value="" disabled selected>Add an item</option>
    @foreach (FoodItem foodItem in DebugUtils.DummyFoods)
    {
        <option value="@foodItem.name">@foodItem</option>
    }
</InputSelect>

<!-- List each food item added to the list -->
@foreach (FoodItem foodItem in foodItems)
{  
    <div>
        <label>>@foodItem</label>
        <div>Calroies: @foodItem.calories</div>
        <div>Protein: @foodItem.protein.value@Utils.MacroToUnitAbbv(Macros.Protein)</div>
        <div>Carbs: @foodItem.carbs.value@Utils.MacroToUnitAbbv(Macros.Carb)</div>
        <div>Fat: @foodItem.fat.value@Utils.MacroToUnitAbbv(Macros.Fat)</div>
    </div>
    <hr />
}

<!-- Disaply totals -->
<div>
    <label>Totals</label>
    <div>Calroies: @foodItems.Sum(i => i.calories)</div>
    <div>Protein: @foodItems.Sum(i => i.protein.value)@Utils.MacroToUnitAbbv(Macros.Protein)</div>
    <div>Carbs: @foodItems.Sum(i => i.carbs.value)@Utils.MacroToUnitAbbv(Macros.Carb)</div>
    <div>Fat: @foodItems.Sum(i => i.fat.value)@Utils.MacroToUnitAbbv(Macros.Fat)</div>
</div>
 

@code
{
    public string? selectedFood { get; private set; }

    private void SetSelectedFood(string? selected)
    {
        if (selected == null) return;

        //Find and add the selected food item
        FoodItem? selectedItem = (DebugUtils.DummyFoods.Find(e => e.name == selected));
        if (selectedItem != null) foodItems.Add(selectedItem);
    }

    private List<FoodItem> foodItems = new List<FoodItem>();
}